<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Runs the WBT for a given data set to evaluate the significance level and 
confidence intervals for the trends between two specified years.  The trends 
evaluated are trends in flow normalized concentration and flow normalized flux.  
Function produces text outputs and a named list (eBoot) that contains all of the 
relevant outputs. Check out runPairsBoot and runGroupsBoot
for more bootstrapping options. 
The wBT only runs stationary flow normalization (i.e. making the assumption that discharge is stationary).  
The runPairsBoot and runGroupsBoot allow for generalized flow normalization (i.e. non-stationary discharge)."><title>Run the WBT (WRTDS Bootstrap Test) — wBT • EGRETci</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Run the WBT (WRTDS Bootstrap Test) — wBT"><meta property="og:description" content="Runs the WBT for a given data set to evaluate the significance level and 
confidence intervals for the trends between two specified years.  The trends 
evaluated are trends in flow normalized concentration and flow normalized flux.  
Function produces text outputs and a named list (eBoot) that contains all of the 
relevant outputs. Check out runPairsBoot and runGroupsBoot
for more bootstrapping options. 
The wBT only runs stationary flow normalization (i.e. making the assumption that discharge is stationary).  
The runPairsBoot and runGroupsBoot allow for generalized flow normalization (i.e. non-stationary discharge)."><meta property="og:image" content="http://usgs-r.github.io/EGRETci/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-53797708-7"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-53797708-7');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://www.usgs.gov/" class="external-link"><img src="logo.png" id="logo" alt="Home" style="padding: 0px 50px 0px 0px;"></a>
    <a class="navbar-brand me-2" href="../index.html">EGRETci</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.4.0002</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/EGRETci.html">Introduction</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Function Help Pages</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/Enhancements.html">Enhancements</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/prediction.html">WRTDS Kalman Prediction Intervals</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://code.usgs.gov/water/EGRETci">
    <span class="fa fa-gitlab fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Run the WBT (WRTDS Bootstrap Test)</h1>
      <small class="dont-index">Source: <a href="https://github.com/USGS-R/EGRETci/blob/HEAD/R/wBTCode.R" class="external-link"><code>R/wBTCode.R</code></a></small>
      <div class="d-none name"><code>wBT.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Runs the WBT for a given data set to evaluate the significance level and 
confidence intervals for the trends between two specified years.  The trends 
evaluated are trends in flow normalized concentration and flow normalized flux.  
Function produces text outputs and a named list (eBoot) that contains all of the 
relevant outputs. Check out <code><a href="runPairsBoot.html">runPairsBoot</a></code> and <code><a href="runGroupsBoot.html">runGroupsBoot</a></code>
for more bootstrapping options. 
The wBT only runs stationary flow normalization (i.e. making the assumption that discharge is stationary).  
The <code><a href="runPairsBoot.html">runPairsBoot</a></code> and <code><a href="runGroupsBoot.html">runGroupsBoot</a></code> allow for generalized flow normalization (i.e. non-stationary discharge).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">wBT</span><span class="op">(</span><span class="va">eList</span>, <span class="va">caseSetUp</span>, saveOutput <span class="op">=</span> <span class="cn">TRUE</span>, fileName <span class="op">=</span> <span class="st">"temp.txt"</span>,</span>
<span>  startSeed <span class="op">=</span> <span class="fl">494817</span>, jitterOn <span class="op">=</span> <span class="cn">FALSE</span>, V <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>eList</dt>
<dd><p>named list with at least the Daily, Sample, and INFO dataframes. Created from the EGRET package, after running <code><a href="https://rdrr.io/pkg/EGRET/man/modelEstimation.html" class="external-link">modelEstimation</a></code>.</p></dd>


<dt>caseSetUp</dt>
<dd><p>data frame. Returned from <code><a href="trendSetUp.html">trendSetUp</a></code>.</p></dd>


<dt>saveOutput</dt>
<dd><p>logical. If <code>TRUE</code>, a text file will be saved in the working directory.</p></dd>


<dt>fileName</dt>
<dd><p>character. Name to save the output file if <code>saveOutput=TRUE</code>.</p></dd>


<dt>startSeed</dt>
<dd><p>setSeed value. Defaults to 494817. This is used to make repeatable output.</p></dd>


<dt>jitterOn</dt>
<dd><p>logical, if TRUE, adds "jitter" to the data in an attempt to avoid some numerical problems.  Default = FALSE.  See Details below.</p></dd>


<dt>V</dt>
<dd><p>numeric a multiplier for addition of jitter to the data, default = 0.2.  See Details below.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>eBoot, a named list with bootOut, wordsOut, xConc, xFlux, pConc, pFlux values.</p><table class="table table"><tr><td>Object</td><td>Description</td></tr><tr><td>bootOut</td><td>a data frame with the results of the bootstrap test.</td></tr><tr><td>wordsOut</td><td>a character vector describing the results.</td></tr><tr><td>xConc and xFlux</td><td>vectors of length iBoot, of the change in flow normalized concentration
   and flow normalized flux computed from each of the bootstrap replicates.</td></tr><tr><td>pConc and pFlux</td><td>vectors of length iBoot, of the change in flow normalized concentration
   or flow normalized flux computed from each of the bootstrap replicates expressed as % change.</td></tr></table></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>In some situations numerical problems are encountered in the bootstrap process, resulting in highly unreasonable spikes in the confidence intervals.
The use of "jitter" can often prevent these problems, but should only be used when it is clearly needed.
It adds a small amount of random "jitter" to the explanatory variables of the WRTDS model.  The V parameter sets the scale of variation in the log discharge values.
The standard deviation of the added jitter is V * standard deviation of Log Q.
The default for V is 0.2.  Larger values should generally be avoided, and smaller values may be sufficient.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="trendSetUp.html">trendSetUp</a></code>, <code><a href="setForBoot.html">setForBoot</a></code>, <code><a href="runGroupsBoot.html">runGroupsBoot</a></code>, <code><a href="runPairsBoot.html">runPairsBoot</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">eList</span> <span class="op">&lt;-</span> <span class="fu">EGRET</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/EGRET/man/sampleData.html" class="external-link">Choptank_eList</a></span></span></span>
<span class="r-in"><span><span class="va">caseSetUp</span> <span class="op">&lt;-</span> <span class="fu"><a href="trendSetUp.html">trendSetUp</a></span><span class="op">(</span><span class="va">eList</span>,</span></span>
<span class="r-in"><span>                        year1 <span class="op">=</span> <span class="fl">1985</span>, </span></span>
<span class="r-in"><span>                        year2 <span class="op">=</span> <span class="fl">2005</span>,</span></span>
<span class="r-in"><span>                        nBoot <span class="op">=</span> <span class="fl">50</span>, </span></span>
<span class="r-in"><span>                        bootBreak <span class="op">=</span> <span class="fl">39</span>,</span></span>
<span class="r-in"><span>                        blockLength <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Sample set runs from 1979 to 2011</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> year1 = 1985 this is the first water year of trend period</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> year2 = 2005 this is the last water year of trend period</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> nBoot = 50 this is the maximum number of replicates that will be run</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> bootBreak = 39 this is the minimum number of replicates that will be run</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> blockLength = 200 this is the number of days in a bootstrap block</span>
<span class="r-in"><span><span class="co"># Very long-running function:                     </span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">eBoot</span> <span class="op">&lt;-</span> <span class="fu">wBT</span><span class="op">(</span><span class="va">eList</span>,<span class="va">caseSetUp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer></footer></div> <!-- / div for your main content-->

<!-- BEGIN USGS Footer Template -->

<footer class="footer"><div class="tmp-container">
		<!-- .footer-wrap -->
			<!-- .footer-doi -->
			<div class="footer-doi">
				<!-- footer nav links -->
				<ul class="menu nav"><li class="first leaf menu-links menu-level-1"><a href="https://www.doi.gov/privacy" class="external-link">DOI Privacy Policy</a></li>
					<li class="leaf menu-links menu-level-1"><a href="https://www.usgs.gov/policies-and-notices" class="external-link">Legal</a></li>
					<li class="leaf menu-links menu-level-1"><a href="https://www.usgs.gov/accessibility-and-us-geological-survey" class="external-link">Accessibility</a></li>
					<li class="leaf menu-links menu-level-1"><a href="https://www.usgs.gov/sitemap" class="external-link">Site Map</a></li>
					<li class="last leaf menu-links menu-level-1"><a href="https://answers.usgs.gov/" class="external-link">Contact USGS</a></li>
				</ul><!--/ footer nav links --></div>
			<!-- /.footer-doi -->

			<hr><!-- .footer-utl-links --><div class="footer-doi">
			<ul class="menu nav"><li class="first leaf menu-links menu-level-1"><a href="https://www.doi.gov/" class="external-link">U.S. Department of the Interior</a></li>
				<li class="leaf menu-links menu-level-1"><a href="https://www.doioig.gov/" class="external-link">DOI Inspector General</a></li>
				<li class="leaf menu-links menu-level-1"><a href="https://www.whitehouse.gov/" class="external-link">White House</a></li>
				<li class="leaf menu-links menu-level-1"><a href="https://www.whitehouse.gov/omb/management/egov/" class="external-link">E-gov</a></li>
				<li class="leaf menu-links menu-level-1"><a href="https://www.doi.gov/pmb/eeo/no-fear-act" class="external-link">No Fear Act</a></li>
				<li class="last leaf menu-links menu-level-1"><a href="https://www.usgs.gov/about/organization/science-support/foia" class="external-link">FOIA</a></li>
			</ul></div>			
		<!-- /.footer-utl-links -->
		<!-- .footer-social-links -->
		<div class="footer-social-links">
			<ul class="social"><li class="follow">Follow</li>
				<li class="twitter">
					<a href="https://twitter.com/usgs" target="_blank" class="external-link">
						<i class="fa fa-twitter-square"><span class="only">Twitter</span></i>
					</a>
				</li>
				<li class="facebook">
					<a href="https://facebook.com/usgeologicalsurvey" target="_blank" class="external-link">
						<i class="fa fa-facebook-square"><span class="only">Facebook</span></i>
					</a>
				</li>
				<li class="github">
					<a href="https://github.com/usgs" target="_blank" class="external-link">
						<i class="fa fa-github"><span class="only">GitHub</span></i>
					</a>
				</li>
				<li class="flickr">
					<a href="https://flickr.com/usgeologicalsurvey" target="_blank" class="external-link">
						<i class="fa fa-flickr"><span class="only">Flickr</span></i>
					</a>
				</li>
				<li class="youtube">
					<a href="http://youtube.com/usgs" target="_blank" class="external-link">
						<i class="fa fa-youtube-play"><span class="only">YouTube</span></i>
					</a>
				</li>
				<li class="instagram">
					<a href="https://instagram.com/usgs" target="_blank" class="external-link">
						<i class="fa fa-instagram"><span class="only">Instagram</span></i>
					</a>
				</li>
			</ul></div>
		<!-- /.footer-social-links -->
	</div>
		<!-- /.footer-wrap -->	
</footer><!-- END USGS Footer Template- --><!-- Google Tag Manager (noscript) --><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TKQR8KP" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
  
  </body><!-- closing div for body --></html>

