<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>ciCalculations — ciCalculations • EGRETci</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="ciCalculations — ciCalculations" />
<meta property="og:description" content="Interactive function to calculate confidence bands for flow normalized concentration or flow normalized flux.
  It returns the data frame CIAnnualResults, which is used as input to the functions
  plotConcHistBoot( ), and plotFluxHistBoot( ) which produce the graphical output." />
<meta property="og:image" content="/logo.png" />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-53797708-7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-53797708-7');
</script>


<!-- dependencies from examples -->


  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EGRETci</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/EGRETci.html">Introduction</a>
</li>
<li>
  <a href="../reference/index.html">Function Help Pages</a>
</li>
<li>
  <a href="../articles/Enhancements.html">Enhancements</a>
</li>
<li>
  <a href="../articles/prediction.html">WRTDS Kalman Prediction Intervals</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/USGS-R/EGRETci">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>ciCalculations</h1>
    <small class="dont-index">Source: <a href='https://github.com/USGS-R/EGRETci/blob/master/R/plotCIs.R'><code>R/plotCIs.R</code></a></small>
    <div class="hidden name"><code>ciCalculations.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Interactive function to calculate confidence bands for flow normalized concentration or flow normalized flux.
  It returns the data frame CIAnnualResults, which is used as input to the functions
  plotConcHistBoot( ), and plotFluxHistBoot( ) which produce the graphical output.</p>
    </div>

    <pre class="usage"><span class='fu'>ciCalculations</span><span class='op'>(</span><span class='va'>eList</span>, startSeed <span class='op'>=</span> <span class='fl'>494817</span>, verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  jitterOn <span class='op'>=</span> <span class='cn'>FALSE</span>, V <span class='op'>=</span> <span class='fl'>0.2</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>eList</th>
      <td><p>named list with at least the Daily, Sample, and INFO dataframes. Created from the EGRET package, after running <code><a href='https://rdrr.io/pkg/EGRET/man/modelEstimation.html'>modelEstimation</a></code>.</p></td>
    </tr>
    <tr>
      <th>startSeed</th>
      <td><p>setSeed value. Defaults to 494817. This is used to make repeatable output.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical specifying whether or not to display progress messag, default = TRUE</p></td>
    </tr>
    <tr>
      <th>jitterOn</th>
      <td><p>logical, if TRUE, adds "jitter" to the data in an attempt to avoid some numerical problems.  Default = FALSE.  See Details below.</p></td>
    </tr>
    <tr>
      <th>V</th>
      <td><p>numeric a multiplier for addition of jitter to the data, default = 0.2.  See Details below.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>optionally include nBoot, blockLength, or widthCI</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>CIAnnualResults a data frame with the following columns
  Year, mean decYear value for the year being reported
  FNConcLow, the lower confidence limit for flow normalized concentration, in mg/L
  FNConcHigh, the upper confidence limit for flow normalized concentration, in mg/L
  FNFluxLow, the lower confidence limit for flow normalized flux, in kg
  FNFluxLow, the lower confidence limit for flow normalized flux, in kg</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>In some situations numerical problems are encountered in the bootstrap process, resulting in highly unreasonable spikes in the confidence intervals.
The use of "jitter" can often prevent these problems, but should only be used when it is clearly needed.
It adds a small amount of random "jitter" to the explanatory variables of the WRTDS model.  The V parameter sets the scale of variation in the log discharge values.
The standard deviation of the added jitter is V * standard deviation of Log Q.
The default for V is 0.2.  Larger values should generally be avoided, and smaller values may be sufficient.</p>
<p>Argument values suggested.  
To test the code nBoot = 10 is sufficient, but for meaningful results nBoot = 100 or even nBoot = 500 are more appropriate.
blockLength = 200
widthCI = 90 (90% confidence interval)</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://pubs.usgs.gov/tm/04/a10/'>EGRET</a></span><span class='op'>)</span>
<span class='va'>eList</span> <span class='op'>&lt;-</span> <span class='va'>Choptank_eList</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'># If run interactively, using stationary flow normalization</span>
<span class='co'># in this format it will prompt for nBoot, blockLength and widthCI.</span>
<span class='co'># CIAnnualResults &lt;- ciCalculations(eList)</span>

<span class='co'># run in batch mode, using non-stationary flow normalization</span>
<span class='co'># In this example nBoot is set very small, useful for an initial trial run.</span>
<span class='co'># A meaningful application would use nBoot values such as 100 or even 500. </span>
<span class='va'>seriesOut_2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/EGRET/man/runSeries.html'>runSeries</a></span><span class='op'>(</span><span class='va'>eList</span>, windowSide <span class='op'>=</span> <span class='fl'>11</span><span class='op'>)</span>
<span class='va'>CIAnnualResults</span> <span class='op'>&lt;-</span> <span class='fu'>ciCalculations</span><span class='op'>(</span><span class='va'>seriesOut_2</span>, 
                     nBoot <span class='op'>=</span> <span class='fl'>10</span>,
                     blockLength <span class='op'>=</span> <span class='fl'>200</span>,
                     widthCI <span class='op'>=</span> <span class='fl'>90</span><span class='op'>)</span>
                     
 <span class='fu'><a href='plotConcHistBoot.html'>plotConcHistBoot</a></span><span class='op'>(</span><span class='va'>seriesOut_2</span>, <span class='va'>CIAnnualResults</span><span class='op'>)</span>

<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Laura DeCicco, Robert Hirsch.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


