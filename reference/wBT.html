<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Run the WBT (WRTDS Bootstrap Test) — wBT • EGRETci</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Run the WBT (WRTDS Bootstrap Test) — wBT" />
<meta property="og:description" content="Runs the WBT for a given data set to evaluate the significance level and 
confidence intervals for the trends between two specified years.  The trends 
evaluated are trends in flow normalized concentration and flow normalized flux.  
Function produces text outputs and a named list (eBoot) that contains all of the 
relevant outputs. Check out runPairsBoot and runGroupsBoot
for more bootstrapping options. 
The wBT only runs stationary flow normalization (i.e. making the assumption that discharge is stationary).  
The runPairsBoot and runGroupsBoot allow for generalized flow normalization (i.e. non-stationary discharge)." />
<meta property="og:image" content="/logo.png" />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-53797708-7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-53797708-7');
</script>


<!-- dependencies from examples -->


  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EGRETci</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.4.0001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/EGRETci.html">Introduction</a>
</li>
<li>
  <a href="../reference/index.html">Function Help Pages</a>
</li>
<li>
  <a href="../articles/Enhancements.html">Enhancements</a>
</li>
<li>
  <a href="../articles/prediction.html">WRTDS Kalman Prediction Intervals</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/USGS-R/EGRETci">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run the WBT (WRTDS Bootstrap Test)</h1>
    <small class="dont-index">Source: <a href='https://github.com/USGS-R/EGRETci/blob/master/R/wBTCode.R'><code>R/wBTCode.R</code></a></small>
    <div class="hidden name"><code>wBT.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Runs the WBT for a given data set to evaluate the significance level and 
confidence intervals for the trends between two specified years.  The trends 
evaluated are trends in flow normalized concentration and flow normalized flux.  
Function produces text outputs and a named list (eBoot) that contains all of the 
relevant outputs. Check out <code><a href='runPairsBoot.html'>runPairsBoot</a></code> and <code><a href='runGroupsBoot.html'>runGroupsBoot</a></code>
for more bootstrapping options. 
The wBT only runs stationary flow normalization (i.e. making the assumption that discharge is stationary).  
The <code><a href='runPairsBoot.html'>runPairsBoot</a></code> and <code><a href='runGroupsBoot.html'>runGroupsBoot</a></code> allow for generalized flow normalization (i.e. non-stationary discharge).</p>
    </div>

    <pre class="usage"><span class='fu'>wBT</span><span class='op'>(</span><span class='va'>eList</span>, <span class='va'>caseSetUp</span>, saveOutput <span class='op'>=</span> <span class='cn'>TRUE</span>, fileName <span class='op'>=</span> <span class='st'>"temp.txt"</span>,
  startSeed <span class='op'>=</span> <span class='fl'>494817</span>, jitterOn <span class='op'>=</span> <span class='cn'>FALSE</span>, V <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>eList</th>
      <td><p>named list with at least the Daily, Sample, and INFO dataframes. Created from the EGRET package, after running <code><a href='https://rdrr.io/pkg/EGRET/man/modelEstimation.html'>modelEstimation</a></code>.</p></td>
    </tr>
    <tr>
      <th>caseSetUp</th>
      <td><p>data frame. Returned from <code><a href='trendSetUp.html'>trendSetUp</a></code>.</p></td>
    </tr>
    <tr>
      <th>saveOutput</th>
      <td><p>logical. If <code>TRUE</code>, a text file will be saved in the working directory.</p></td>
    </tr>
    <tr>
      <th>fileName</th>
      <td><p>character. Name to save the output file if <code>saveOutput=TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>startSeed</th>
      <td><p>setSeed value. Defaults to 494817. This is used to make repeatable output.</p></td>
    </tr>
    <tr>
      <th>jitterOn</th>
      <td><p>logical, if TRUE, adds "jitter" to the data in an attempt to avoid some numerical problems.  Default = FALSE.  See Details below.</p></td>
    </tr>
    <tr>
      <th>V</th>
      <td><p>numeric a multiplier for addition of jitter to the data, default = 0.2.  See Details below.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>eBoot, a named list with bootOut, wordsOut, xConc, xFlux, pConc, pFlux values.</p><table class='table'>
<tr><td>Object</td><td>Description</td></tr>
<tr><td>bootOut</td><td>a data frame with the results of the bootstrap test.</td></tr>
<tr><td>wordsOut</td><td>a character vector describing the results.</td></tr>
<tr><td>xConc and xFlux</td><td>vectors of length iBoot, of the change in flow normalized concentration
   and flow normalized flux computed from each of the bootstrap replicates.</td></tr>
<tr><td>pConc and pFlux</td><td>vectors of length iBoot, of the change in flow normalized concentration
   or flow normalized flux computed from each of the bootstrap replicates expressed as <!-- % change. \cr --></td></tr>
</table>


    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>In some situations numerical problems are encountered in the bootstrap process, resulting in highly unreasonable spikes in the confidence intervals.
The use of "jitter" can often prevent these problems, but should only be used when it is clearly needed.
It adds a small amount of random "jitter" to the explanatory variables of the WRTDS model.  The V parameter sets the scale of variation in the log discharge values.
The standard deviation of the added jitter is V * standard deviation of Log Q.
The default for V is 0.2.  Larger values should generally be avoided, and smaller values may be sufficient.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='trendSetUp.html'>trendSetUp</a></code>, <code><a href='setForBoot.html'>setForBoot</a></code>, <code><a href='runGroupsBoot.html'>runGroupsBoot</a></code>, <code><a href='runPairsBoot.html'>runPairsBoot</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>eList</span> <span class='op'>&lt;-</span> <span class='fu'>EGRET</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/EGRET/man/sampleData.html'>Choptank_eList</a></span>
<span class='va'>caseSetUp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='trendSetUp.html'>trendSetUp</a></span><span class='op'>(</span><span class='va'>eList</span>,
                        year1 <span class='op'>=</span> <span class='fl'>1985</span>, 
                        year2 <span class='op'>=</span> <span class='fl'>2005</span>,
                        nBoot <span class='op'>=</span> <span class='fl'>50</span>, 
                        bootBreak <span class='op'>=</span> <span class='fl'>39</span>,
                        blockLength <span class='op'>=</span> <span class='fl'>200</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Sample set runs from 1979 to 2011</span></div><div class='output co'>#&gt; <span class='message'>year1 = 1985 this is the first water year of trend period</span></div><div class='output co'>#&gt; <span class='message'>year2 = 2005 this is the last water year of trend period</span></div><div class='output co'>#&gt; <span class='message'>nBoot = 50 this is the maximum number of replicates that will be run</span></div><div class='output co'>#&gt; <span class='message'>bootBreak = 39 this is the minimum number of replicates that will be run</span></div><div class='output co'>#&gt; <span class='message'>blockLength = 200 this is the number of days in a bootstrap block</span></div><div class='input'><span class='co'># Very long-running function:                     </span>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>eBoot</span> <span class='op'>&lt;-</span> <span class='fu'>wBT</span><span class='op'>(</span><span class='va'>eList</span>,<span class='va'>caseSetUp</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Laura DeCicco, Robert Hirsch.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


